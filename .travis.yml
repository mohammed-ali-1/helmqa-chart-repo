language: python

env:
  global:
    - REPO_DIR=/home/travis/build/hello-world-chart-repo
    - REPO_URL=https://github.com/mohammed-ali-1/hello-world-chart-repo.git
    - HELMQA_URL=https://helmqa-helmqa.a3c1.starter-us-west-1.openshiftapps.com
    - HELM_URL=https://storage.googleapis.com/kubernetes-helm
    - HELM_TGZ=helm-v2.9.1-linux-amd64.tar.gz
    - OUT_DIR=out
    - secure: WpsB+JKdRbl0FgAOaPyvaIyGnFsTZqsQMlrqb14EBtVmBZFAQjerAPD+xG3c5pKxEFGPB7YpjLbOKSgS0u30Zh7LkFvkgh8AAfcnYPEjCHClQMtg3osLqPCp/lwvS3JWbJQwE1oUMqg+T7yMCsO3gsIepbWqvVxlZ+efFPckaY670goExmx9RLcjFwgCzyxUetRfnyL4zSfl4tb39X+sm5vkXipyxYV0LKNomXYForRwMOZeUQe3G+CruN1hDsAXgDG4OhCAe20dud9qOtafAWbYtYrJncmqHgH6fNtXZUPZvwIxYD0bBVWLp45F7l9Q2j7k+hJQ3V9IrIy4K4hlVbSbCf9udsWgRdyqIO+pT3ICtYiPoBQVTmwbEf/uIDC7YZKAbIYrVKTo8zfCMd8ftw/VGMrCmeOEREarwkQ/kBHz4NucxrGlFI3zt5l7tJ1y+IzyD8OpCOURJdgp+4xKcFpSm6fXavbleLB6PkSznnou2D6MJ0gusBMMJiYia3Dz1LHooKQ6mCkUujM4AxTdHkOnpvqgv6Ac1TQm9ioJSJ1ti7gKkp1itWDQszVouro4vzioxA1dugCMTOcV15LEgjHW1e9jXGpJY29NZ0xpRq5cv/PkVmCduWbvgD9dWu8hgFHAUvR5iNAcam3Xz86mXVbHz4nREwyVw7oNB1f8gsA=

before_install:
 - chmod +x .ci/build.sh

 install:
 - curl -sSLo /tmp/helm.tgz "${HELM_URL}/${HELM_TGZ}"
 - tar -xzvf /tmp/helm.tgz
 - PATH=$(pwd)/linux-amd64/:$PATH
 - helm init --client-only
 - sudo apt-get install jq

before_script:
 - git fetch origin gh-pages

script: ./.ci/build.sh

deploy:
  provider: pages
  local-dir: $OUT_DIR
  skip-cleanup: true
  github-token: $GITHUB_TOKEN
  keep-history: true
  on:
    branch: master